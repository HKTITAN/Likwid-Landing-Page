<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Complete AI Content Generation Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: #f9f9f9;
        }
        
        .test-section h2 {
            color: #555;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .topic-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            margin: 10px 0;
            resize: vertical;
            min-height: 80px;
        }
        
        .topic-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .test-data {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        
        .example-topics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .example-topic {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        
        .example-topic:hover {
            background: #e0e0e0;
            transform: translateY(-1px);
        }
        
        .navigation {
            text-align: center;
            margin-top: 30px;
        }
        
        .navigation a {
            color: white;
            text-decoration: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 10px 20px;
            border-radius: 8px;
            margin: 0 10px;
            display: inline-block;
            transition: transform 0.2s;
        }
        
        .navigation a:hover {
            transform: translateY(-2px);
        }
        
        .generation-steps {
            list-style: none;
            padding: 0;
        }
        
        .generation-steps li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .step-status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .step-pending {
            background: #e0e0e0;
            color: #666;
        }
        
        .step-active {
            background: #667eea;
            color: white;
            animation: pulse 1.5s infinite;
        }
        
        .step-complete {
            background: #28a745;
            color: white;
        }
        
        .step-error {
            background: #dc3545;
            color: white;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .feature-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            text-align: center;
        }
        
        .feature-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .feature-card p {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Complete AI Content Generation Test</h1>
        
        <div class="test-section">
            <h2>Progressive AI Content Generation</h2>
            <p>This tests the new <strong>generateCompleteContent()</strong> function that creates:</p>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üìù Refined Content Brief</h4>
                    <p>AI analyzes and enhances your topic input</p>
                </div>
                <div class="feature-card">
                    <h4>üîë Strategic Keywords</h4>
                    <p>Generates targeted keywords from CSV database</p>
                </div>
                <div class="feature-card">
                    <h4>üìñ Complete Blog Post</h4>
                    <p>Creates comprehensive, structured content</p>
                </div>
                <div class="feature-card">
                    <h4>üéØ SEO Optimization</h4>
                    <p>Meta titles, descriptions, and optimization</p>
                </div>
                <div class="feature-card">
                    <h4>üñºÔ∏è Featured Image</h4>
                    <p>AI-generated professional images</p>
                </div>
                <div class="feature-card">
                    <h4>üí° Content Suggestions</h4>
                    <p>Improvement recommendations</p>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>Test Topic Input</h2>
            <textarea 
                id="topic-input" 
                class="topic-input" 
                placeholder="Enter your topic idea (e.g., 'AI automation in manufacturing', 'ERP implementation challenges', 'predictive maintenance benefits')..."
            ></textarea>
            
            <div class="example-topics">
                <div class="example-topic" onclick="setTopic('Smart factory automation benefits for small manufacturers')">
                    Smart factory automation benefits for small manufacturers
                </div>
                <div class="example-topic" onclick="setTopic('How to calculate ROI on ERP system implementation')">
                    How to calculate ROI on ERP system implementation
                </div>
                <div class="example-topic" onclick="setTopic('Predictive maintenance vs reactive maintenance strategies')">
                    Predictive maintenance vs reactive maintenance strategies
                </div>
                <div class="example-topic" onclick="setTopic('Supply chain optimization using AI and machine learning')">
                    Supply chain optimization using AI and machine learning
                </div>
                <div class="example-topic" onclick="setTopic('Quality control automation in manufacturing processes')">
                    Quality control automation in manufacturing processes
                </div>
                <div class="example-topic" onclick="setTopic('Industry 4.0 transformation roadmap for traditional manufacturers')">
                    Industry 4.0 transformation roadmap for traditional manufacturers
                </div>
            </div>
            
            <button onclick="testCompleteGeneration()">üöÄ Generate Complete Content Package</button>
            <button onclick="testPromptRefinement()" style="background: #28a745;">üìù Test Prompt Refinement Only</button>
            <button onclick="testKeywordGeneration()" style="background: #ffc107; color: #000;">üîë Test Keyword Strategy Only</button>
            <button onclick="testImageGeneration()" style="background: #17a2b8;">üñºÔ∏è Test Image Generation Only</button>
        </div>
        
        <div class="test-section">
            <h2>Generation Progress</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <ul class="generation-steps" id="generation-steps">
                <li><span class="step-status step-pending" id="step-1">1</span> Prompt Refinement</li>
                <li><span class="step-status step-pending" id="step-2">2</span> Strategic Keyword Generation</li>
                <li><span class="step-status step-pending" id="step-3">3</span> Blog Post Creation</li>
                <li><span class="step-status step-pending" id="step-4">4</span> SEO Optimization</li>
                <li><span class="step-status step-pending" id="step-5">5</span> Image Generation</li>
                <li><span class="step-status step-pending" id="step-6">6</span> Content Analysis & Suggestions</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>Generation Results</h2>
            <div id="results-container"></div>
        </div>
        
        <div class="navigation">
            <a href="blog-editor.html">Try in Blog Editor</a>
            <a href="test-ai-comprehensive.html">AI Test Suite</a>
            <a href="test-blog-workflow.html">Blog Workflow Test</a>
        </div>
    </div>

    <script src="ai-service.js"></script>
    <script>
        const aiService = new AIService();
        let currentStep = 0;
        const totalSteps = 6;
        
        function setTopic(topic) {
            document.getElementById('topic-input').value = topic;
        }
        
        function updateProgress(step, status = 'active') {
            const stepEl = document.getElementById(`step-${step}`);
            const progressFill = document.getElementById('progress-fill');
            
            // Reset all steps to pending if starting over
            if (step === 1 && status === 'active') {
                for (let i = 1; i <= totalSteps; i++) {
                    const el = document.getElementById(`step-${i}`);
                    el.className = 'step-status step-pending';
                    el.textContent = i;
                }
            }
            
            if (status === 'active') {
                stepEl.className = 'step-status step-active';
                stepEl.innerHTML = '‚ü≥';
                currentStep = step;
            } else if (status === 'complete') {
                stepEl.className = 'step-status step-complete';
                stepEl.innerHTML = '‚úì';
            } else if (status === 'error') {
                stepEl.className = 'step-status step-error';
                stepEl.innerHTML = '‚úó';
            }
            
            const progress = status === 'complete' ? (step / totalSteps) * 100 : ((step - 1) / totalSteps) * 100;
            progressFill.style.width = progress + '%';
        }
        
        function showResult(title, data, type = 'info') {
            const container = document.getElementById('results-container');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.innerHTML = `
                <h3>${title}</h3>
                <div class="test-data">${typeof data === 'object' ? JSON.stringify(data, null, 2) : data}</div>
            `;
            container.appendChild(resultDiv);
            container.scrollTop = container.scrollHeight;
        }
        
        function clearResults() {
            document.getElementById('results-container').innerHTML = '';
        }
        
        async function testCompleteGeneration() {
            const topic = document.getElementById('topic-input').value.trim();
            if (!topic) {
                alert('Please enter a topic first!');
                return;
            }
            
            clearResults();
            
            try {
                showResult('üöÄ Starting Complete Content Generation', `Topic: "${topic}"`, 'info');
                
                updateProgress(1, 'active');
                const completeContent = await aiService.generateCompleteContent(topic);
                
                // Show step completions
                updateProgress(1, 'complete');
                showResult('‚úÖ Step 1: Prompt Refinement Complete', completeContent.refinedBrief, 'success');
                
                updateProgress(2, 'complete');
                showResult('‚úÖ Step 2: Strategic Keywords Generated', completeContent.keywordStrategy, 'success');
                
                updateProgress(3, 'complete');
                showResult('‚úÖ Step 3: Blog Post Created', {
                    title: completeContent.blogPost.title,
                    category: completeContent.blogPost.category,
                    excerpt: completeContent.blogPost.excerpt,
                    contentBlocks: completeContent.blogPost.content.blocks.length,
                    author: completeContent.blogPost.author
                }, 'success');
                
                updateProgress(4, 'complete');
                showResult('‚úÖ Step 4: SEO Optimization Complete', {
                    meta_title: completeContent.blogPost.meta_title,
                    meta_description: completeContent.blogPost.meta_description,
                    slug: completeContent.blogPost.slug,
                    seo_score: completeContent.seoAnalysis.score
                }, 'success');
                
                updateProgress(5, 'complete');
                showResult('‚úÖ Step 5: Image Generated', {
                    image_url: completeContent.imageData.url ? 'Generated successfully' : 'Failed',
                    alt_text: completeContent.imageData.altText,
                    description: completeContent.imageData.description
                }, 'success');
                
                updateProgress(6, 'complete');
                showResult('‚úÖ Step 6: Content Analysis Complete', completeContent.contentSuggestions, 'success');
                
                showResult('üéâ Complete Generation Summary', {
                    original_input: completeContent.originalInput,
                    processing_steps: completeContent.processingSteps,
                    generation_id: completeContent.generationId,
                    generated_at: completeContent.generatedAt,
                    total_features: completeContent.processingSteps.length
                }, 'success');
                
            } catch (error) {
                updateProgress(currentStep, 'error');
                showResult('‚ùå Generation Failed', error.message, 'error');
                console.error('Complete generation failed:', error);
            }
        }
        
        async function testPromptRefinement() {
            const topic = document.getElementById('topic-input').value.trim();
            if (!topic) {
                alert('Please enter a topic first!');
                return;
            }
            
            clearResults();
            
            try {
                showResult('üìù Testing Prompt Refinement', `Input: "${topic}"`, 'info');
                const refinedBrief = await aiService.refineUserPrompt(topic);
                showResult('‚úÖ Prompt Refinement Results', refinedBrief, 'success');
            } catch (error) {
                showResult('‚ùå Prompt Refinement Failed', error.message, 'error');
            }
        }
        
        async function testKeywordGeneration() {
            const topic = document.getElementById('topic-input').value.trim();
            if (!topic) {
                alert('Please enter a topic first!');
                return;
            }
            
            clearResults();
            
            try {
                showResult('üîë Testing Keyword Generation', `Topic: "${topic}"`, 'info');
                
                // First refine the prompt
                const refinedBrief = await aiService.refineUserPrompt(topic);
                showResult('üìù Refined Brief', refinedBrief, 'info');
                
                // Then generate keywords
                const keywords = await aiService.generateStrategicKeywords(refinedBrief);
                showResult('‚úÖ Strategic Keywords Generated', keywords, 'success');
                
                // Show CSV keyword analysis
                const csvAnalysis = aiService.findRelevantCSVKeywords(topic, 15);
                showResult('üìä CSV Keyword Analysis', {
                    total_csv_keywords: aiService.keywords.length,
                    relevant_matches: csvAnalysis,
                    match_count: csvAnalysis.length
                }, 'info');
                
            } catch (error) {
                showResult('‚ùå Keyword Generation Failed', error.message, 'error');
            }
        }
        
        async function testImageGeneration() {
            const topic = document.getElementById('topic-input').value.trim();
            if (!topic) {
                alert('Please enter a topic first!');
                return;
            }
            
            clearResults();
            
            try {
                showResult('üñºÔ∏è Testing Image Generation', `Topic: "${topic}"`, 'info');
                
                // Refine the prompt for image context
                const refinedBrief = await aiService.refineUserPrompt(topic);
                
                // Generate image
                const imageResult = await aiService.generateContentImage(topic, refinedBrief);
                
                showResult('‚úÖ Image Generated Successfully', {
                    prompt_used: imageResult.prompt,
                    alt_text: imageResult.altText,
                    description: imageResult.description,
                    image_url: imageResult.imageUrl ? 'Generated' : 'Failed'
                }, 'success');
                
                // Display the image if generated
                if (imageResult.imageUrl) {
                    const imageDiv = document.createElement('div');
                    imageDiv.className = 'test-result info';
                    imageDiv.innerHTML = `
                        <h3>üñºÔ∏è Generated Image Preview</h3>
                        <img src="${imageResult.imageUrl}" alt="${imageResult.altText}" style="max-width: 100%; border-radius: 8px; margin: 10px 0;">
                        <p><strong>Alt Text:</strong> ${imageResult.altText}</p>
                    `;
                    document.getElementById('results-container').appendChild(imageDiv);
                }
                
            } catch (error) {
                showResult('‚ùå Image Generation Failed', error.message, 'error');
            }
        }
        
        // Initialize
        window.addEventListener('load', () => {
            showResult('üîß AI Service Initialized', {
                api_configured: aiService.isConfigured(),
                keywords_loaded: aiService.keywords.length > 0,
                keyword_count: aiService.keywords.length,
                service_status: aiService.getStatus()
            }, 'info');
        });
    </script>
</body>
</html>
